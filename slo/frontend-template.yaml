version: "prometheus/v1"
service: "frontend"
labels:
  owner: "frontend-team"
  repo: "frontend-repo"
  tier: "2"
slos:
  # We allow failing (5xx and 429) 1 request every 1000 requests (99.9%).
  - name: "availability"
    objective: 99.9
    description: "Common SLO based on availability for HTTP request responses."
    sli:
      events:
        error_query: sum(rate(traces_span_metrics_calls_total{service_name="frontend", status_code="STATUS_CODE_ERROR"}[{{.window}}]))
        total_query: sum(rate(traces_span_metrics_calls_total{service_name="frontend"}[{{.window}}]))
    alerting:
      name: FrontendHighErrorRate
      labels:
        category: "availability"
      annotations:
        # Overwrite default Sloth SLO alert summmary on ticket and page alerts.
        summary: "High error rate on 'frontend' requests responses"
      page_alert:
        labels:
          severity: pageteam
          routing_key: myteam
      ticket_alert:
        labels:
          severity: "slack"
          slack_channel: "#alerts-myteam"
  - name: "latency-250ms"
    objective: 99.9
    description: "Common SLO based on latency for HTTP request responses."
    sli:
      events:
        error_query: sum(rate(traces_span_metrics_latency_bucket{service_name="frontend", le="250"}[{{.window}}]))
        total_query: sum(rate(traces_span_metrics_latency_count{service_name="frontend"}[{{.window}}]))
    alerting:
      name: FrontendHighLatency
      labels:
        category: "latency"
      annotations:
        # Overwrite default Sloth SLO alert summmary on ticket and page alerts.
        summary: "High latency on 'frontend' requests responses"
      page_alert:
        labels:
          severity: pageteam
          routing_key: myteam
      ticket_alert:
        labels:
          severity: "slack"
          slack_channel: "#alerts-myteam"